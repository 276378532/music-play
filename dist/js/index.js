var songList,controlManger,$=window.Zepto,root=window.player,index=0,audio=new root.audioControl;function bindEvent(){$scope.on("play:change",function(o,n){audio.getAudio(songList[n].audio)}),$scope.on("click",".prev-btn",function(){index=controlManger.prev(),root.renderInfo(songList[index],".song-info"),root.renderImg(songList[index],".img-wrapper img"),root.renderIsLike(songList[index],".control .like-btn"),root.renderAllTime(songList[index].duration),audio.getAudio(songList[index].audio),"pause"===audio.status?(root.stop(),root.clear(),root.updata(0)):(root.stop(),root.clear(),root.start(),audio.play())}),$scope.on("click",".next-btn",function(){index=controlManger.next(),root.renderInfo(songList[index],".song-info"),root.renderImg(songList[index],".img-wrapper img"),root.renderIsLike(songList[index],".control .like-btn"),root.renderAllTime(songList[index].duration),audio.getAudio(songList[index].audio),"pause"===audio.status?(root.stop(),root.clear(),root.updata(0)):(root.stop(),root.clear(),root.start(),audio.play())}),$scope.on("click",".play-btn",function(){"play"==audio.status?(audio.pause(),root.stop()):(audio.play(),root.start()),$(this).toggleClass("pause")})}function bindTouch(){var o=$scope.find(".slider-pointer"),n=$scope.find(".pro-wrapper").offset(),r=n.left,e=n.width;o.on("touchstart",function(){root.stop()}).on("touchmove",function(o){var n=(o.changedTouches[0].clientX-r)/e;(n<0||1<n)&&(n=0),root.updata(n)}).on("touchend",function(o){var n=(o.changedTouches[0].clientX-r)/e;(n<0||1<n)&&(n=0);var t=n*songList[controlManger.index].duration;audio.playTo(t),root.start(n)})}function getDate(o){$.ajax({type:"GET",url:o,success:function(o){songList=o,controlManger=new root.controlManger(songList.length),root.renderInfo(songList[0],".song-info"),root.renderImg(songList[0],".img-wrapper img"),root.renderIsLike(songList[0],".control .like-btn"),root.renderAllTime(songList[0].duration),bindEvent(),$scope.trigger("play:change",0),bindTouch()},error:function(){}})}getDate("../mock/data.json");